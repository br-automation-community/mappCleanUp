
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="index.html">
      
      
        <link rel="next" href="revision.html">
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.1">
    
    
      
        <title>Description - mappCleanUp sample</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.a40c8224.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="extra.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="orange" data-md-color-accent="orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#command-structure" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="mappCleanUp sample" class="md-header__button md-logo" aria-label="mappCleanUp sample" data-md-component="logo">
      
  <img src="images/bur.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            mappCleanUp sample
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Description
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/br-automation-com/mappCleanUp" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub Repo
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="mappCleanUp sample" class="md-nav__button md-logo" aria-label="mappCleanUp sample" data-md-component="logo">
      
  <img src="images/bur.png" alt="logo">

    </a>
    mappCleanUp sample
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/br-automation-com/mappCleanUp" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub Repo
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Start
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Description
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="description.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Description
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#command-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Command structure
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pre-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Pre-Configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-handling" class="md-nav__link">
    <span class="md-ellipsis">
      Error handling
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="revision.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Revision
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Description</h1>

<p>The sample consists of a task that can be copied and pasted into your project. Files can be deleted by the following criteria.</p>
<ul>
<li>Delete oldest file</li>
<li>Delete all files older than a certain date and time</li>
<li>Delete oldest file until a certain amount of files are left</li>
<li>Delete oldest file until a certain amount of space is free</li>
</ul>
<p><strong><span style="color:red">Important Note:</span></strong> When using the parameter "Pattern" in combination with maximum files or minimum space, the task will only delete files that match the pattern but will use the total number of files or space as a reference. For example, if the pattern is set to ".csv" files and the maximum number of files is set to 10. The directory contain 8 files that match the pattern but 15 files in total. The task will delete 5 files that match the pattern to get the total number of files down to 10.</p>
<h2 id="command-structure">Command structure</h2>
<p>The task uses a variable structure to communicate with the outside world that can also be used to interact with other tasks. The structure <em>CleanUp</em> looks as follows:</p>
<table>

    <tr>
        <th width="100">Level 1</th>
        <th>Level 2</th>
        <th>Level Description</th>
    </tr>
    <tr>
        <td>CMD</td>
        <td colspan="3">Used to trigger a command</td>
    </tr>
    <tr>
        <td></td>
        <td>DeleteMaxFiles</td>
        <td colspan="3">Delete oldest file until a certain amount of files are left.</td>
    </tr>
    <tr>
        <td></td>
        <td>DeleteMinSpace</td>
        <td colspan="3">Delete oldest file until a certain amount of space is free.</td>
    </tr>
    <tr>
        <td></td>
        <td>DeleteOldest</td>
        <td colspan="3">Delete oldest file.</td>
    </tr>
    <tr>
        <td></td>
        <td>DeleteOlderThan</td>
        <td colspan="3">Delete all files older than a certain date and time.</td>
    </tr>
    <tr>
        <td></td>
        <td>UpdateFreeSpace</td>
        <td colspan="3">Update free space information. (CleanUp.DAT.FreeSpace)</td>
    </tr>
    <tr>
        <td></td>
        <td>ErrorReset</td>
        <td colspan="3">Reset error.</td>
    </tr>
    <tr>
        <td>PAR</td>
        <td colspan="3">Parameter structure</td>
    </tr>
    <tr>
        <td></td>
        <td>Simulate</td>
        <td colspan="3">Files are only listed but not actually deleted. <strong>The default value is true to protect the user from accidently deleting files.</strong> </td>
    </tr>
    <tr>
        <td></td>
        <td>Device</td>
        <td colspan="3">Device name.</td>
    </tr>
    <tr>
        <td></td>
        <td>Path</td>
        <td colspan="3">Path to files.</td>
    </tr>
    <tr>
        <td></td>
        <td>MaxFilesToKeep</td>
        <td colspan="3">Maximum number of files to keep. (Command DeleteMaxFiles)</td>
    </tr>
    <tr>
        <td></td>
        <td>MinSpace</td>
        <td colspan="3">Delete files until minimum space is available. (Command DeleteMinSpace)</td>
    </tr>
    <tr>
        <td></td>
        <td>OlderThan</td>
        <td colspan="3">Delete all files older than this date. (Command DeleteOlderThan)</td>
    </tr>
    <tr>
        <td></td>
        <td>Pattern</td>
        <td colspan="3">File must match this pattern (ex. .pdf or .csv).</td>
    </tr>
    <tr>
        <td>DAT</td>
        <td colspan="3">Return data from command.</td>
    </tr>
    <tr>
        <td></td>
        <td>FilesList</td>
        <td colspan="3">List of files that were deleted. Only the first x deleted files are listed here.</td>
    </tr>
    <tr>
        <td></td>
        <td>FilesDeleted</td>
        <td colspan="3">Number of files that were deleted.</td>
    </tr>
    <tr>
        <td></td>
        <td>FilesCount</td>
        <td colspan="3">Number of files left in the directory.</td>
    </tr>
    <tr>
        <td></td>
        <td>FreeSpace</td>
        <td colspan="3">Free space on the media.</td>
    </tr>
    <tr>
        <td>ERR</td>
        <td colspan="3">Information about errors.</td>
    </tr>
    <tr>
        <td></td>
        <td>State</td>
        <td colspan="3">State where the error occurred.</td>
    </tr>
    <tr>
        <td></td>
        <td>Text</td>
        <td colspan="3">Error text.</td>
    </tr>
    <tr>
        <td>Status</td>
        <td colspan="3">Shows the status as number</td>
    </tr>

</table>

<h2 id="pre-configuration">Pre-Configuration</h2>
<p>The following constants can be adjusted if necessary.</p>
<table>
<thead>
<tr>
<th>Constant</th>
<th>Default</th>
<th>Text</th>
</tr>
</thead>
<tbody>
<tr>
<td>FILE_NAME_LEN</td>
<td>200</td>
<td>Maximum file name length.</td>
</tr>
</tbody>
</table>
<h2 id="error-handling">Error handling</h2>
<p>The task generates the following list of error messages. All other error numbers are generated from included libraries that can be found in the Automation Studio help.</p>
<table>
<thead>
<tr>
<th>No</th>
<th>Constant</th>
<th>Text</th>
</tr>
</thead>
<tbody>
<tr>
<td>10000</td>
<td>CLEANUP_ERR_FILE_NAME_TO_LONG</td>
<td>File name + path exceeds maximum file name length</td>
</tr>
<tr>
<td>10001</td>
<td>CLEANUP_ERR_PAR_IS_EMPTY</td>
<td>Corresponding parameter for command is empty</td>
</tr>
<tr>
<td>10002</td>
<td>CLEANUP_ERR_MIN_SPACE</td>
<td>Minimum space could not be achieved</td>
</tr>
<tr>
<td>10003</td>
<td>CLEANUP_ERR_MIN_FILES</td>
<td>Minimum number of files could not be achieved</td>
</tr>
</tbody>
</table>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": "toc.integrate", "search": "assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.5090c770.min.js"></script>
      
    
  </body>
</html>